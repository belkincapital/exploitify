<?php

function exploitify_panel() {

    exploitify_is_checked("exploitify_check_one");
    exploitify_is_checked("exploitify_check_two");
    exploitify_is_checked("exploitify_check_three");
    exploitify_is_checked("exploitify_check_four");
    exploitify_is_checked("exploitify_check_five");
    exploitify_is_checked("exploitify_check_six");
    exploitify_is_checked("exploitify_check_seven");
    exploitify_is_checked("exploitify_check_eight");
    exploitify_is_checked("exploitify_check_nine");
    exploitify_is_checked("exploitify_check_ten");
 
?>
<style>
.wrap h2 a {text-decoration:none;color:#333333}
.wrap h2 a:hover {text-decoration:underline;color:#333333}
th label{padding-left:10px}
th,td{border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1}
.form-table{margin-top:0px}
#exploitify {font-size:13px;padding-left:10px;padding-right:10px}
#exploitify ul {background:#fafafa;border:1px solid #e1e1e1;padding-left:10px;padding-top:10px;padding-right:10px}
#exploitify li {line-height:14px;margin:0px}
#exploitify p {line-height:14px}
#exploitify b {line-height:16px;font-size:16px}
#exploitify strong {font-weight:bold;font-size:16px;padding-right:5px}
#exploitify_settings label {font-size:13px}
input.exp_checkbox {margin-left:10px}
.whatsthat {background:#fafafa;border:1px solid #e1e1e1;padding-left:4px;padding-top:4px;padding-right:4px;padding-bottom:4px;margin-left:10px;margin-top:10px;margin-right:0px;font-size:12px;}
</style>
<div class="wrap">
<h2><a target="_blank" href="http://exploitify.com/"><b>Exploitify</b> WordPress Security</a></h2><br />

<div class="postbox" id="exploitify">
<table class="form-table" id="exploitify_table">
<tbody>
<ul>
<b>How does the database work?</b>
<p>As of July 2015, the database consists of over 1.1M IP, 2.4M email addresses and nearly 1M domain names. The database is automatically generated based on global activity.</p>
<p>The database entries are added in two ways:</p>
<li><strong>-</strong> If it is ruled that a particular commentor is a spammer, then the IP, Email and any associated domains, each entry is assigned 1 point.</li>
<li><strong>-</strong> If it is ruled that a particular registration is a spammer, then the IP, Email and any associated domains, each entry is assigned 1 point.</li>
<p>After reaching 3 points on 3 different sites, entries are automatically entered in the blacklist. Removal from the blacklist is automatic or by reducing the number of credit units to 2 or less, or when no spam activity over 45 days is reached. We can't remove anyone from the blacklist. If someone is added to the blacklist they must wait for the system to remove them.</p>
</ul>
</tbody>
</table>
</div>

<form action="" method="post">
<div class="postbox" id="exploitify_settings">
<table class="form-table">
<tbody>

<tr valign="top" id="exploitify_tr_one">
<th scope="row">
    <label for="home">Filter IP Traffic</label>
</th>
<td>
    <label for="exploitify_check_one" class="exp_label">
        <?php if (isset($_SERVER["HTTP_CF_CONNECTING_IP"])) { ?>
        <input name="exploitify_check_one" type="checkbox" disabled="disabled" class="exp_checkbox" id="exploitify_check_one" value="1" <?php echo get_option("exploitify_check_one");?>>
        <small><i>Check to enable. <span style="color:red">(not available to Cloudflare users)</span></i></small>
        <?php } else { ?>
        <input name="exploitify_check_one" type="checkbox" class="exp_checkbox" id="exploitify_check_one" value="1" <?php echo get_option("exploitify_check_one");?>>
        <small><i>Check to enable.</i></small>
        <?php } ?>
        <div class="whatsthat">This will check your visitors IP address against the database to help you mitigate your website from potential botnets and spammers.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_two">
<th scope="row">
    <label for="home">Comment Author</label>
</th>
<td>
    <label for="exploitify_check_three" class="exp_label">
       <input name="exploitify_check_three" type="checkbox" class="exp_checkbox" id="exploitify_check_three" value="1" <?php echo get_option("exploitify_check_three");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">This will check your comment authors email address against the database to help you fight spam.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_ten">
<th scope="row">
    <label for="home">Comment URL</label>
</th>
<td>
    <label for="exploitify_check_ten" class="exp_label">
       <input name="exploitify_check_ten" type="checkbox" class="exp_checkbox" id="exploitify_check_ten" value="1" <?php echo get_option("exploitify_check_ten");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">This will remove the author URL from all new comments submitted on your website.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_three">
<th scope="row">
    <label for="home">Registration Email</label>
</th>
<td>
    <label for="exploitify_check_four" class="exp_label">
       <input name="exploitify_check_four" type="checkbox" class="exp_checkbox" id="exploitify_check_four" value="1" <?php echo get_option("exploitify_check_four");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">This will check your registrant users email address against the database to help protect against bot registrations.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_four">
<th scope="row">
    <label for="home">Verify UserAgent</label>
</th>
<td>
    <label for="exploitify_check_five" class="exp_label">
       <input name="exploitify_check_five" type="checkbox" class="exp_checkbox" id="exploitify_check_five" value="1" <?php echo get_option("exploitify_check_five");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">This will check to see if your visitors have a browser UserAgent, and if they don't, then deny access to the site to them.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_five">
<th scope="row">
    <label for="home">Disable XMLRPC</label>
</th>
<td>
    <label for="exploitify_check_six" class="exp_label">
       <input name="exploitify_check_six" type="checkbox" class="exp_checkbox" id="exploitify_check_six" value="1" <?php echo get_option("exploitify_check_six");?>>
       <small><i>Check to disable.</i></small>
       <div class="whatsthat">Depending on your situation, you may want to disable XMLRPC. This will disbale XML-RPC API in WordPress 3.5+, which is enabled by default.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_six">
<th scope="row">
    <label for="home">Login Notification</label>
</th>
<td>
    <label for="exploitify_check_seven" class="exp_label">
       <input name="exploitify_check_seven" type="checkbox" class="exp_checkbox" id="exploitify_check_seven" value="1" <?php echo get_option("exploitify_check_seven");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">Enabling this option will send an email to registered users when someone including themselves successfully logs into their account.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_seven">
<th scope="row">
    <label for="home">Login Errors</label>
</th>
<td>
    <label for="exploitify_check_eight" class="exp_label">
       <input name="exploitify_check_eight" type="checkbox" class="exp_checkbox" id="exploitify_check_eight" value="1" <?php echo get_option("exploitify_check_eight");?>>
       <small><i>Check to disable.</i></small>
       <div class="whatsthat">This option will hide all login error messages. Typically, bots look for login errors to help them identify correct usernames.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_nine">
<th scope="row">
    <label for="home">Logout Session</label>
</th>
<td>
    <label for="exploitify_check_nine" class="exp_label">
       <input name="exploitify_check_nine" type="checkbox" class="exp_checkbox" id="exploitify_check_nine" value="1" <?php echo get_option("exploitify_check_nine");?>>
       <small><i>Check to enable.</i></small>
       <div class="whatsthat">This option will destroy your session on logout. This means that if this option is enabled, when you logout of your site, you will also be logged out of all devices.</div>
    </label>
</td>
</tr>

<tr valign="top" id="exploitify_tr_eight">
<th scope="row">
    <label for="home">Backend Filtering</label>
</th>
<td>
    <label for="exploitify_check_two" class="exp_label">
       <?php if (isset($_SERVER["HTTP_CF_CONNECTING_IP"])) { ?>
       <input name="exploitify_check_two" type="checkbox" disabled="disabled" class="exp_checkbox" id="exploitify_check_two" value="1" <?php echo get_option("exploitify_check_two");?>>
       <small><i>Check to enable. <span style="color:red">(not available to Cloudflare users)</span></i></small>
       <?php } else { ?>
       <input name="exploitify_check_two" type="checkbox" class="exp_checkbox" id="exploitify_check_two" value="1" <?php echo get_option("exploitify_check_two");?>>
       <small><i>Check to enable. <span style="color:red">(not recommended)</span></i></small>
       <?php } ?>
       <div class="whatsthat">In case you see some strange botnet activity, this will check all wp-admin traffic against the IP address database. Also, a browser UserAgent is verified, and if it doesn't, then we deny access to the wp-admin to them. Depending on your setup and circumstances, this can be either extremely handy or dangerous. So be cautious using this and if by chance you block yourself, simply remove the plugin within your web hosting file manager or via ftp.</div>
    </label>
</td>
</tr>

</tbody>
</table>
</div>

<input type="hidden" name="exploitify_fs" value="1">
<input type="submit" class="button button-primary" value="Save Changes">
</form>

</div><!--/.wrap -->
<?php

}
